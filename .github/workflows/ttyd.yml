name: Persistent 12-Hour ttyd VM

on:
  workflow_dispatch:

jobs:
  start-vm:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Fetch vm-data branch if exists
      run: git fetch origin vm-data || echo "No vm-data branch found."

    - name: Restore VM data (if any)
      run: |
        if [ -d vm_data ]; then
          echo "Restoring VM data..."
          cp -r vm_data/* .
        fi

    - name: Make start.sh executable
      run: chmod +x ./start.sh

    - name: Run start.sh
      run: ./start.sh
